
Training options:
{
  "G_args": {
    "func_name": "training.networks_3d.G_main",
    "fmap_base": 4096,
    "fmap_max": 128,
    "mapping_layers": 8,
    "num_fp16_res": 4,
    "conv_clamp": 256,
    "architecture": "orig",
    "fmap_min": 12,
    "fmap_decay": 1.6,
    "base_dim": [
      5,
      6,
      7
    ]
  },
  "D_args": {
    "func_name": "training.networks_3d.D_main",
    "mbstd_group_size": 2,
    "fmap_base": 4096,
    "fmap_max": 128,
    "num_fp16_res": 4,
    "conv_clamp": 256,
    "architecture": "resnet",
    "fmap_min": 12,
    "fmap_decay": 1.6,
    "base_dim": [
      5,
      6,
      7
    ]
  },
  "G_opt_args": {
    "beta1": 0.0,
    "beta2": 0.99,
    "learning_rate": 0.002
  },
  "D_opt_args": {
    "beta1": 0.0,
    "beta2": 0.99,
    "learning_rate": 0.002
  },
  "loss_args": {
    "func_name": "training.loss_3d.stylegan2",
    "r1_gamma": 0
  },
  "augment_args": {
    "class_name": "training.augment_3d.AdaptiveAugment"
  },
  "num_gpus": 8,
  "image_snapshot_ticks": 1,
  "network_snapshot_ticks": 1,
  "train_dataset_args": {
    "path": "/data/vision/polina/users/razvan/sungmin/stylegan2/sbatch/script_real_data/TFRecords/TFRecords_Float32_Shuffle0",
    "max_label_size": 0,
    "resolution": 224,
    "mirror_augment": false
  },
  "metric_arg_list": [
    {
      "name": "fid50k",
      "class_name": "metrics_3d.frechet_inception_distance.FID",
      "max_reals": 50000,
      "num_fakes": 50000,
      "minibatch_per_gpu": 8,
      "force_dataset_args": {
        "shuffle": false,
        "max_images": null
      }
    }
  ],
  "metric_dataset_args": {
    "path": "/data/vision/polina/users/razvan/sungmin/stylegan2/sbatch/script_real_data/TFRecords/TFRecords_Float32_Shuffle0",
    "max_label_size": 0,
    "resolution": 224,
    "mirror_augment": false
  },
  "total_kimg": 6000,
  "minibatch_size": 16,
  "minibatch_gpu": 2,
  "G_smoothing_kimg": 10,
  "G_smoothing_rampup": null,
  "run_dir": "results/noaug_ada_3d_curated_real-Gorig-Dresnet/00015-TFRecords_Float32_Shuffle0-stylegan2-3d-anisobase-kimg6000-noaug"
}

Output directory:  results/noaug_ada_3d_curated_real-Gorig-Dresnet/00015-TFRecords_Float32_Shuffle0-stylegan2-3d-anisobase-kimg6000-noaug
Training data:     /data/vision/polina/users/razvan/sungmin/stylegan2/sbatch/script_real_data/TFRecords/TFRecords_Float32_Shuffle0
Training length:   6000 kimg
Resolution:        224
Number of GPUs:    8

Creating output directory...
Loading training set...
Image shape: [1, 160, 192, 224]
Label shape: [0]
training_set.shape 
[1, 160, 192, 224]
training_set.base_dim
[5, 6, 7]
Constructing networks...
===========================================
G_synthesis
resolution : 
128
===========================================
Setting up TensorFlow plugin "fused_bias_act.cu": Loading... Done.
===========================================
G_synthesis
resolution : 
128
===========================================

G                                 Params   OutputShape             WeightShape        
---                               ---      ---                     ---                
latents_in                        -        (?, 128)                -                  
labels_in                         -        (?, 0)                  -                  
G_mapping/Normalize               -        (?, 128)                -                  
G_mapping/Dense0                  16512    (?, 128)                (128, 128)         
G_mapping/Dense1                  16512    (?, 128)                (128, 128)         
G_mapping/Dense2                  16512    (?, 128)                (128, 128)         
G_mapping/Dense3                  16512    (?, 128)                (128, 128)         
G_mapping/Dense4                  16512    (?, 128)                (128, 128)         
G_mapping/Dense5                  16512    (?, 128)                (128, 128)         
G_mapping/Dense6                  16512    (?, 128)                (128, 128)         
G_mapping/Dense7                  16512    (?, 128)                (128, 128)         
G_mapping/Broadcast               -        (?, 12, 128)            -                  
dlatent_avg                       -        (128,)                  -                  
Truncation/Lerp                   -        (?, 12, 128)            -                  
G_synthesis/5x6x7/Const           26880    (?, 128, 5, 6, 7)       (1, 128, 5, 6, 7)  
G_synthesis/5x6x7/Conv            459009   (?, 128, 5, 6, 7)       (3, 3, 3, 128, 128)
G_synthesis/10x12x14/Conv0_up     459009   (?, 128, 10, 12, 14)    (3, 3, 3, 128, 128)
G_synthesis/10x12x14/Conv1        459009   (?, 128, 10, 12, 14)    (3, 3, 3, 128, 128)
G_synthesis/20x24x28/Conv0_up     459009   (?, 128, 20, 24, 28)    (3, 3, 3, 128, 128)
G_synthesis/20x24x28/Conv1        459009   (?, 128, 20, 24, 28)    (3, 3, 3, 128, 128)
G_synthesis/40x48x56/Conv0_up     182449   (?, 48, 40, 48, 56)     (3, 3, 3, 128, 48) 
G_synthesis/40x48x56/Conv1        68449    (?, 48, 40, 48, 56)     (3, 3, 3, 48, 48)  
G_synthesis/80x96x112/Conv0_up    26945    (?, 16, 80, 96, 112)    (3, 3, 3, 48, 16)  
G_synthesis/80x96x112/Conv1       8993     (?, 16, 80, 96, 112)    (3, 3, 3, 16, 16)  
G_synthesis/160x192x224/Conv0_up  7261     (?, 12, 160, 192, 224)  (3, 3, 3, 16, 12)  
G_synthesis/160x192x224/Conv1     5449     (?, 12, 160, 192, 224)  (3, 3, 3, 12, 12)  
G_synthesis/160x192x224/ToRGB     1561     (?, 1, 160, 192, 224)   (1, 1, 1, 12, 1)   
---                               ---      ---                     ---                
Total                             2755128                                             

===========================================
D_main
resolution : 
128
===========================================

D                       Params   OutputShape             WeightShape        
---                     ---      ---                     ---                
images_in               -        (?, 1, 160, 192, 224)   -                  
labels_in               -        (?, 0)                  -                  
160x192x224/FromRGB     24       (?, 12, 160, 192, 224)  (1, 1, 1, 1, 12)   
160x192x224/Conv0       3900     (?, 12, 160, 192, 224)  (3, 3, 3, 12, 12)  
160x192x224/Conv1_down  5200     (?, 16, 80, 96, 112)    (3, 3, 3, 12, 16)  
160x192x224/Skip        192      (?, 16, 80, 96, 112)    (1, 1, 1, 12, 16)  
80x96x112/Conv0         6928     (?, 16, 80, 96, 112)    (3, 3, 3, 16, 16)  
80x96x112/Conv1_down    20784    (?, 48, 40, 48, 56)     (3, 3, 3, 16, 48)  
80x96x112/Skip          768      (?, 48, 40, 48, 56)     (1, 1, 1, 16, 48)  
40x48x56/Conv0          62256    (?, 48, 40, 48, 56)     (3, 3, 3, 48, 48)  
40x48x56/Conv1_down     166016   (?, 128, 20, 24, 28)    (3, 3, 3, 48, 128) 
40x48x56/Skip           6144     (?, 128, 20, 24, 28)    (1, 1, 1, 48, 128) 
20x24x28/Conv0          442496   (?, 128, 20, 24, 28)    (3, 3, 3, 128, 128)
20x24x28/Conv1_down     442496   (?, 128, 10, 12, 14)    (3, 3, 3, 128, 128)
20x24x28/Skip           16384    (?, 128, 10, 12, 14)    (1, 1, 1, 128, 128)
10x12x14/Conv0          442496   (?, 128, 10, 12, 14)    (3, 3, 3, 128, 128)
10x12x14/Conv1_down     442496   (?, 128, 5, 6, 7)       (3, 3, 3, 128, 128)
10x12x14/Skip           16384    (?, 128, 5, 6, 7)       (1, 1, 1, 128, 128)
5x6x7/MinibatchStddev   -        (?, 129, 5, 6, 7)       -                  
5x6x7/Conv              445952   (?, 128, 5, 6, 7)       (3, 3, 3, 129, 128)
5x6x7/Dense0            3440768  (?, 128)                (26880, 128)       
Output                  129      (?, 1)                  (128, 1)           
---                     ---      ---                     ---                
Total                   5961813                                             

Exporting sample images...
Initialize data arrays
Random LayOut
2021-02-15 23:56:58.355761: W tensorflow/compiler/jit/mark_for_compilation_pass.cc:1412] (One-time warning): Not using XLA:CPU for cluster because envvar TF_XLA_FLAGS=--tf_xla_cpu_global_jit was not set.  If you want XLA:CPU, either set that envvar, or use experimental_jit_scope to enable XLA:CPU.  To confirm that XLA is active, pass --vmodule=xla_compilation_cache=1 (as a proper command-line flag, not via TF_XLA_FLAGS) or set the envvar XLA_FLAGS=--xla_hlo_profile.
Class Conditional LayOut
=====================================
 save_image_grid 
images.shape
(60, 1, 160, 192)
images range
0.0
0.8666667
0.15796523
=====================================
===========================================
G_synthesis
resolution : 
128
===========================================
===========================================
G_synthesis
resolution : 
128
===========================================
===========================================
G_synthesis
resolution : 
128
===========================================
=====================================
 save_image_grid 
images.shape
(60, 1, 160, 192, 224)
========================================
create_3d_image_grid: grid_size
========================================
(10, 6)
========================================
create_3d_image_grid: grid_w
========================================
10
========================================
create_3d_image_grid: grid_h
========================================
6
========================================
create_3d_image_grid: image.shape
========================================
(60, 1, 160, 192, 224)
===============================
image.ndim
===============================
2
===============================
image.shape
===============================
(1152, 2240)
===============================
img_d
===============================
160
Replicating networks across 8 GPUs...
Initializing augmentations...
Setting up optimizers...
Constructing training graph...
===========================================
G_synthesis
resolution : 
128
===========================================
===========================================
D_main
resolution : 
128
===========================================
===========================================
D_main
resolution : 
128
===========================================
===========================================
G_synthesis
resolution : 
128
===========================================
===========================================
G_synthesis
resolution : 
128
===========================================
===========================================
G_synthesis
resolution : 
128
===========================================
===========================================
G_synthesis
resolution : 
128
===========================================
===========================================
D_main
resolution : 
128
===========================================
===========================================
D_main
resolution : 
128
===========================================
===========================================
D_main
resolution : 
128
===========================================
===========================================
G_synthesis
resolution : 
128
===========================================
===========================================
G_synthesis
resolution : 
128
===========================================
===========================================
G_synthesis
resolution : 
128
===========================================
===========================================
G_synthesis
resolution : 
128
===========================================
===========================================
D_main
resolution : 
128
===========================================
===========================================
D_main
resolution : 
128
===========================================
===========================================
D_main
resolution : 
128
===========================================
===========================================
G_synthesis
resolution : 
128
===========================================
===========================================
G_synthesis
resolution : 
128
===========================================
===========================================
G_synthesis
resolution : 
128
===========================================
===========================================
G_synthesis
resolution : 
128
===========================================
===========================================
D_main
resolution : 
128
===========================================
===========================================
D_main
resolution : 
128
===========================================
===========================================
D_main
resolution : 
128
===========================================
===========================================
G_synthesis
resolution : 
128
===========================================
===========================================
G_synthesis
resolution : 
128
===========================================
===========================================
G_synthesis
resolution : 
128
===========================================
===========================================
G_synthesis
resolution : 
128
===========================================
===========================================
D_main
resolution : 
128
===========================================
===========================================
D_main
resolution : 
128
===========================================
===========================================
D_main
resolution : 
128
===========================================
===========================================
G_synthesis
resolution : 
128
===========================================
===========================================
G_synthesis
resolution : 
128
===========================================
===========================================
G_synthesis
resolution : 
128
===========================================
===========================================
G_synthesis
resolution : 
128
===========================================
===========================================
D_main
resolution : 
128
===========================================
===========================================
D_main
resolution : 
128
===========================================
===========================================
D_main
resolution : 
128
===========================================
===========================================
G_synthesis
resolution : 
128
===========================================
===========================================
G_synthesis
resolution : 
128
===========================================
===========================================
G_synthesis
resolution : 
128
===========================================
===========================================
G_synthesis
resolution : 
128
===========================================
===========================================
D_main
resolution : 
128
===========================================
===========================================
D_main
resolution : 
128
===========================================
===========================================
D_main
resolution : 
128
===========================================
===========================================
G_synthesis
resolution : 
128
===========================================
===========================================
G_synthesis
resolution : 
128
===========================================
===========================================
G_synthesis
resolution : 
128
===========================================
===========================================
G_synthesis
resolution : 
128
===========================================
===========================================
D_main
resolution : 
128
===========================================
===========================================
D_main
resolution : 
128
===========================================
===========================================
D_main
resolution : 
128
===========================================
===========================================
G_synthesis
resolution : 
128
===========================================
Finalizing training ops...
no metrics...
Training for 6000 kimg...

tick 0     kimg 0.0      time 10m 20s      sec/tick 123.6   sec/kimg 7726.25 maintenance 496.1  gpumem 5.2   augment 0.000
=====================================
 save_image_grid 
images.shape
(60, 1, 160, 192, 224)
========================================
create_3d_image_grid: grid_size
========================================
(10, 6)
========================================
create_3d_image_grid: grid_w
========================================
10
========================================
create_3d_image_grid: grid_h
========================================
6
========================================
create_3d_image_grid: image.shape
========================================
(60, 1, 160, 192, 224)
===============================
image.ndim
===============================
2
===============================
image.shape
===============================
(1152, 2240)
===============================
img_d
===============================
160
tick 1     kimg 4.0      time 1h 07m 35s   sec/tick 3309.5  sec/kimg 827.37  maintenance 125.6  gpumem 5.2   augment 0.000
=====================================
 save_image_grid 
images.shape
(60, 1, 160, 192, 224)
========================================
create_3d_image_grid: grid_size
========================================
(10, 6)
========================================
create_3d_image_grid: grid_w
========================================
10
========================================
create_3d_image_grid: grid_h
========================================
6
========================================
create_3d_image_grid: image.shape
========================================
(60, 1, 160, 192, 224)
===============================
image.ndim
===============================
2
===============================
image.shape
===============================
(1152, 2240)
===============================
img_d
===============================
160
tick 2     kimg 8.0      time 2h 03m 12s   sec/tick 3309.3  sec/kimg 827.33  maintenance 27.6   gpumem 5.2   augment 0.000
=====================================
 save_image_grid 
images.shape
(60, 1, 160, 192, 224)
========================================
create_3d_image_grid: grid_size
========================================
(10, 6)
========================================
create_3d_image_grid: grid_w
========================================
10
========================================
create_3d_image_grid: grid_h
========================================
6
========================================
create_3d_image_grid: image.shape
========================================
(60, 1, 160, 192, 224)
===============================
image.ndim
===============================
2
===============================
image.shape
===============================
(1152, 2240)
===============================
img_d
===============================
160
tick 3     kimg 12.0     time 2h 58m 58s   sec/tick 3316.2  sec/kimg 829.04  maintenance 30.4   gpumem 5.2   augment 0.000
=====================================
 save_image_grid 
images.shape
(60, 1, 160, 192, 224)
========================================
create_3d_image_grid: grid_size
========================================
(10, 6)
========================================
create_3d_image_grid: grid_w
========================================
10
========================================
create_3d_image_grid: grid_h
========================================
6
========================================
create_3d_image_grid: image.shape
========================================
(60, 1, 160, 192, 224)
===============================
image.ndim
===============================
2
===============================
image.shape
===============================
(1152, 2240)
===============================
img_d
===============================
160
tick 4     kimg 16.0     time 3h 54m 46s   sec/tick 3317.6  sec/kimg 829.41  maintenance 30.4   gpumem 5.2   augment 0.000
=====================================
 save_image_grid 
images.shape
(60, 1, 160, 192, 224)
========================================
create_3d_image_grid: grid_size
========================================
(10, 6)
========================================
create_3d_image_grid: grid_w
========================================
10
========================================
create_3d_image_grid: grid_h
========================================
6
========================================
create_3d_image_grid: image.shape
========================================
(60, 1, 160, 192, 224)
===============================
image.ndim
===============================
2
===============================
image.shape
===============================
(1152, 2240)
===============================
img_d
===============================
160
tick 5     kimg 20.0     time 4h 50m 39s   sec/tick 3322.3  sec/kimg 830.57  maintenance 30.2   gpumem 5.2   augment 0.000
=====================================
 save_image_grid 
images.shape
(60, 1, 160, 192, 224)
========================================
create_3d_image_grid: grid_size
========================================
(10, 6)
========================================
create_3d_image_grid: grid_w
========================================
10
========================================
create_3d_image_grid: grid_h
========================================
6
========================================
create_3d_image_grid: image.shape
========================================
(60, 1, 160, 192, 224)
===============================
image.ndim
===============================
2
===============================
image.shape
===============================
(1152, 2240)
===============================
img_d
===============================
160
tick 6     kimg 24.0     time 5h 46m 43s   sec/tick 3335.6  sec/kimg 833.90  maintenance 28.7   gpumem 5.2   augment 0.000
=====================================
 save_image_grid 
images.shape
(60, 1, 160, 192, 224)
========================================
create_3d_image_grid: grid_size
========================================
(10, 6)
========================================
create_3d_image_grid: grid_w
========================================
10
========================================
create_3d_image_grid: grid_h
========================================
6
========================================
create_3d_image_grid: image.shape
========================================
(60, 1, 160, 192, 224)
===============================
image.ndim
===============================
2
===============================
image.shape
===============================
(1152, 2240)
===============================
img_d
===============================
160
tick 7     kimg 28.0     time 6h 42m 52s   sec/tick 3338.6  sec/kimg 834.64  maintenance 30.4   gpumem 5.2   augment 0.000
=====================================
 save_image_grid 
images.shape
(60, 1, 160, 192, 224)
========================================
create_3d_image_grid: grid_size
========================================
(10, 6)
========================================
create_3d_image_grid: grid_w
========================================
10
========================================
create_3d_image_grid: grid_h
========================================
6
========================================
create_3d_image_grid: image.shape
========================================
(60, 1, 160, 192, 224)
===============================
image.ndim
===============================
2
===============================
image.shape
===============================
(1152, 2240)
===============================
img_d
===============================
160
tick 8     kimg 32.0     time 7h 39m 07s   sec/tick 3345.2  sec/kimg 836.29  maintenance 29.4   gpumem 5.2   augment 0.000
=====================================
 save_image_grid 
images.shape
(60, 1, 160, 192, 224)
========================================
create_3d_image_grid: grid_size
========================================
(10, 6)
========================================
create_3d_image_grid: grid_w
========================================
10
========================================
create_3d_image_grid: grid_h
========================================
6
========================================
create_3d_image_grid: image.shape
========================================
(60, 1, 160, 192, 224)
===============================
image.ndim
===============================
2
===============================
image.shape
===============================
(1152, 2240)
===============================
img_d
===============================
160
tick 9     kimg 36.0     time 8h 35m 17s   sec/tick 3340.0  sec/kimg 835.00  maintenance 30.6   gpumem 5.2   augment 0.000
=====================================
 save_image_grid 
images.shape
(60, 1, 160, 192, 224)
========================================
create_3d_image_grid: grid_size
========================================
(10, 6)
========================================
create_3d_image_grid: grid_w
========================================
10
========================================
create_3d_image_grid: grid_h
========================================
6
========================================
create_3d_image_grid: image.shape
========================================
(60, 1, 160, 192, 224)
===============================
image.ndim
===============================
2
===============================
image.shape
===============================
(1152, 2240)
===============================
img_d
===============================
160
tick 10    kimg 40.0     time 9h 31m 34s   sec/tick 3346.7  sec/kimg 836.68  maintenance 29.9   gpumem 5.2   augment 0.000
=====================================
 save_image_grid 
images.shape
(60, 1, 160, 192, 224)
========================================
create_3d_image_grid: grid_size
========================================
(10, 6)
========================================
create_3d_image_grid: grid_w
========================================
10
========================================
create_3d_image_grid: grid_h
========================================
6
========================================
create_3d_image_grid: image.shape
========================================
(60, 1, 160, 192, 224)
===============================
image.ndim
===============================
2
===============================
image.shape
===============================
(1152, 2240)
===============================
img_d
===============================
160
tick 11    kimg 44.0     time 10h 27m 46s  sec/tick 3341.4  sec/kimg 835.36  maintenance 30.5   gpumem 5.2   augment 0.000
=====================================
 save_image_grid 
images.shape
(60, 1, 160, 192, 224)
========================================
create_3d_image_grid: grid_size
========================================
(10, 6)
========================================
create_3d_image_grid: grid_w
========================================
10
========================================
create_3d_image_grid: grid_h
========================================
6
========================================
create_3d_image_grid: image.shape
========================================
(60, 1, 160, 192, 224)
===============================
image.ndim
===============================
2
===============================
image.shape
===============================
(1152, 2240)
===============================
img_d
===============================
160
tick 12    kimg 48.0     time 11h 24m 07s  sec/tick 3352.0  sec/kimg 837.99  maintenance 29.0   gpumem 5.2   augment 0.000
=====================================
 save_image_grid 
images.shape
(60, 1, 160, 192, 224)
========================================
create_3d_image_grid: grid_size
========================================
(10, 6)
========================================
create_3d_image_grid: grid_w
========================================
10
========================================
create_3d_image_grid: grid_h
========================================
6
========================================
create_3d_image_grid: image.shape
========================================
(60, 1, 160, 192, 224)
===============================
image.ndim
===============================
2
===============================
image.shape
===============================
(1152, 2240)
===============================
img_d
===============================
160
